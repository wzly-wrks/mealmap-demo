<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meal Map - Project Angel Food</title>
    <link rel="stylesheet" href="src/css/style.css">
    <link rel="stylesheet" href="src/css/user_interface.css">
    <link rel="stylesheet" href="src/css/admin-panel.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
    <link href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.1/mapbox-gl-draw.css" rel="stylesheet">
    <link href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css" rel="stylesheet">
</head>
<body class="light-mode">
    <!-- Loading screen -->
    <div id="loading-screen">
        <div class="loader-container">
            <div class="logo-loader">
                <img src="assets/paf-logo.png" alt="Project Angel Food Logo" class="logo-image">
            </div>
            <div class="loading-text">Loading Meal Map...</div>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- Main container -->
    <div id="app-container" style="display: none;">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="assets/paf-logo.png" alt="Project Angel Food Logo" class="logo-image">
                <h1>Meal Map</h1>
            </div>
            <div class="controls">
                <div id="day-selector-root" class="day-selector"></div>
                <div class="toggle-container">
                    <label class="toggle-switch">
                        <input type="checkbox" id="darkModeToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-icon light"><i class="fas fa-sun"></i></span>
                        <span class="toggle-icon dark"><i class="fas fa-moon"></i></span>
                    </label>
                </div>
                <button id="adminButton" class="icon-button" title="Admin Panel">
                    <i class="fas fa-lock"></i>
                </button>
                <button id="helpButton" class="icon-button" title="Help">
                    <i class="fas fa-question-circle"></i>
                </button>
                <button id="faqButton" class="icon-button" title="FAQ">
                    <i class="fas fa-info-circle"></i>
                </button>
            </div>
        </header>

        <!-- Main content -->
        <main>
            <div id="map"></div>
            <div id="sidebar">
                <div class="sidebar-section">
                    <h3>Zone Information</h3>
                    <div id="zoneInfo">
                        <p>Click on a zone to see details</p>
                    </div>
                </div>
                <div class="sidebar-section">
                    <h3>Address Search</h3>
                    <div class="search-container">
                        <input type="text" id="addressSearch" placeholder="Enter an address...">
                        <button id="searchButton"><i class="fas fa-search"></i></button>
                    </div>
                    <div id="searchResults"></div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <p>&copy; 2025 Project Angel Food | Meal Map v1.0</p>
            </div>
        </footer>
    </div>

    <!-- Walkthrough overlay -->
    <div id="walkthrough-overlay" class="hidden">
        <div class="walkthrough-container">
            <div class="walkthrough-header">
                <h2>Welcome to Meal Map!</h2>
                <button id="closeWalkthrough" class="close-button">&times;</button>
            </div>
            <div class="walkthrough-content">
                <div class="walkthrough-step" data-step="1">
                    <h3>Getting Started</h3>
                    <p>This interactive map helps you manage delivery routes across LA County.</p>
                    <img src="https://placehold.co/600x400?text=Map+Overview" alt="Map Overview">
                </div>
                <div class="walkthrough-step hidden" data-step="2">
                    <h3>Day Selection</h3>
                    <p>Use the day selector to view routes for specific days of the week.</p>
                    <img src="https://placehold.co/600x400?text=Day+Selection" alt="Day Selection">
                </div>
                <div class="walkthrough-step hidden" data-step="3">
                    <h3>Zone Information</h3>
                    <p>Click on any zone to view detailed information about it.</p>
                    <img src="https://placehold.co/600x400?text=Zone+Information" alt="Zone Information">
                </div>
                <div class="walkthrough-step hidden" data-step="4">
                    <h3>Address Search</h3>
                    <p>Search for addresses to find which zone they belong to.</p>
                    <img src="https://placehold.co/600x400?text=Address+Search" alt="Address Search">
                </div>
                <div class="walkthrough-step hidden" data-step="5">
                    <h3>Admin Features</h3>
                    <p>Administrators can edit zones, manage routes, and configure API settings.</p>
                    <img src="https://placehold.co/600x400?text=Admin+Features" alt="Admin Features">
                </div>
            </div>
            <div class="walkthrough-navigation">
                <button id="prevStep" disabled>Previous</button>
                <div class="walkthrough-dots">
                    <span class="dot active" data-step="1"></span>
                    <span class="dot" data-step="2"></span>
                    <span class="dot" data-step="3"></span>
                    <span class="dot" data-step="4"></span>
                    <span class="dot" data-step="5"></span>
                </div>
                <button id="nextStep">Next</button>
            </div>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div id="faqModal" class="modal">
        <div class="modal-content animate__animated">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> Frequently Asked Questions</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="faq-item">
                    <h3>What is Meal Map?</h3>
                    <p>Meal Map is a custom web application designed for Project Angel Food to manage delivery routes across LA County. It helps visualize and organize delivery zones by day of the week.</p>
                </div>
                <div class="faq-item">
                    <h3>How do I search for an address?</h3>
                    <p>Use the address search box in the sidebar. Enter an address and click the search button. The map will show you which zone the address belongs to.</p>
                </div>
                <div class="faq-item">
                    <h3>What do the different colors mean?</h3>
                    <p>Each delivery zone is color-coded based on the day of the week. Restricted zones are shown in gray.</p>
                </div>
                <div class="faq-item">
                    <h3>How do I edit zones?</h3>
                    <p>Zone editing is available in the Admin Panel. Click the lock icon, enter your admin password, and use the Zone Editor tab.</p>
                </div>
                <div class="faq-item">
                    <h3>Can I see delivery routes?</h3>
                    <p>Yes, delivery routes are displayed as colored overlays on the map. Select a day to see the routes for that day.</p>
                </div>
                <div class="faq-item">
                    <h3>How do I reset the walkthrough?</h3>
                    <p>You can reset the walkthrough from the Admin Panel under the "General Settings" section.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Include admin panel HTML -->
    <div id="admin-panel-container"></div>

    <!-- Scripts -->
    <script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>        <!-- Toast notifications -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.1/mapbox-gl-draw.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
    <!-- React dependencies -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="src/js/react/day-selector.js"></script>
    <script src="config.js"></script>
    <script src="src/js/routes.js"></script>
    <script src="src/js/mapbox.js"></script>
    <script src="src/js/van_overlay.js"></script>
    <script src="src/js/user_interface.js"></script>
    <script>
        // Load admin panel HTML
        document.addEventListener('DOMContentLoaded', function() {
            fetch('src/components/admin-panel.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('admin-panel-container').innerHTML = html;
                    // Load admin panel script after HTML is loaded
                    const script = document.createElement('script');
                    script.src = 'src/components/admin-panel.js';
                    document.body.appendChild(script);
                });
        });
    </script>
    <script src="src/js/encryption-utils.js"></script>
    <script src="src/components/admin-panel-fix.js"></script>
    <script src="src/js/route-assignments.js"></script>
    <script src="src/js/route-manager.js"></script>
</body>
</html>